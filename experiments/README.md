# Эксперименты с GAN

# Общее описание экспериментов
В задании нужно было реализовать сеть, которая на основании фотографий двух лиц генерировала бы новое лицо, похожее одновременно на оба лица. Мы попробовали две сети, которые, строго говоря, являются не GAN, а автоэнкодерами, но решают ту же задачу.

## Декодер на готовых эмбеддингах
Мы взяли эмбеддинги, которые считает предобученная модель `facenet`, и на основании этих эмбеддингов попытались восстановить лицо. Чтобы восстановить лицо, которое похоже на два заданных, нужно взять среднее их эмбеддиногов и пропустить через сеть. В основе сети несколько полносвязных слоёв, ReLU и сигмоида, чтобы получать значения из отрезка [0, 1].
Интересно, что изначально эти эмбеддинги были обучены для задачи классификации, но и лицо восстанавливать по ним получается более-менее сносно. Результаты ниже. 
Код самой сети можно посмотреть в файле `decoder.py`, обучение в файлах `train_decoder.py`и `train_decoder.ipynb` (то же самое, но с комментариями и графиками). Тестирование декодера в файле `test_decoder.py`. 
Для обучения использовалась функция потерь `binary_cross_entropy`, метод оптимизации `Adam`.
Готовая модель лежит по адресу https://yadi.sk/d/hBk0e6gZ3VNnxK в файле `decoder_model`, отдельно только параметры модели в файле `decoder_state`.


## Свёрточный автоэнкодер
Механизм работы примерно такой же, как и у декодера выше. Но только мы строим полноценный автоэнкодер из энкодера (несколько свёрточных слоёв с пуллингом) и декодера (столько же свёрточных слоёв с апсемплингом). На выходе энкодера получаем сжатое векторное представление картинки. Затем для двух картинок усредняем их векторные представления и подаём на вход декодеру, пытаясь восстановить лицо, похожее одновременно на две заданные картинки. Результат получается довольно размытый. 
Код самой сети, её обучение и тестирование можно посмотреть в файле `decoder_conv.ipynb`
Для обучения использовалась функция потерь `binary_cross_entropy`, метод оптимизации `Adam`.
Параметры предобученной модели лежат по адресу https://yadi.sk/d/hBk0e6gZ3VNnxK в файле `autoencoder_state`.

# Результаты экспериментов
## Набор №1
**Полносвязный декодер**
![Полносвязный декодер](https://github.com/sgjurano/ysda-celebrity-faces/blob/master/experiments/fc_1.png "Полносвязный декодер №1")
**Свёрточный декодер**
![Свёрточный декодер](https://github.com/sgjurano/ysda-celebrity-faces/blob/master/experiments/conv_1.png "Свёрточный декодер №1")
## Набор №2
**Полносвязный декодер**
![Полносвязный декодер](https://github.com/sgjurano/ysda-celebrity-faces/blob/master/experiments/fc_2.png "Полносвязный декодер №2")
**Свёрточный декодер**
![Свёрточный декодер](https://github.com/sgjurano/ysda-celebrity-faces/blob/master/experiments/conv_2.png "Свёрточный декодер №2")
